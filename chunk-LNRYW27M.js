import{a as O,b as R}from"./chunk-EELPIEAV.js";import{F as M,G as P}from"./chunk-WFRBO4E6.js";import{A as h,o as c,r as u,t as j,v as g,y as x}from"./chunk-DYR6BFEB.js";import{e as A}from"./chunk-FAF55DAL.js";function p(o,r,t){let e=t.asArray(),n=r.asArray();for(let i=0;i<16;i++)e[i]=n[i];return e[12]-=o.x,e[13]-=o.y,e[14]-=o.z,t.markAsUpdated(),t}function m(o,r,t){return u(r,s),p(o,s,f),u(f,t),t}function l(o,r,t){if(!_.eyeAtCamera)return m(o,r,t);let e=t.asArray(),n=r.asArray();for(let i=0;i<16;i++)e[i]=n[i];return e[12]=0,e[13]=0,e[14]=0,t.markAsUpdated(),t}function w(o,r,t,e){return c(l(o,r,e),t,e),e}function B(o,r,t){return t.normal.copyFrom(r.normal),t.d=r.d+g.Dot(r.normal,o),t}function E(o,r,t,e,n){for(let i=0;i<e;++i)W(o,r[i],t[i],s),s.copyToArray(n,i*16);return n}function F(o,r,t,e){return u(t,s),c(r,s,f),p(o,f,s),l(o,t,f),c(s,f,e),e}function W(o,r,t,e){return m(o,r,f),c(f,t,e),e}function T(o,r,t,e,n,i){return u(t,s),c(r,s,f),p(o,f,s),w(o,e,n,f),c(s,f,i),i}function V(o,r){let t=_.getScene();if(!t||a===r)return r;a.updateFlag=r.updateFlag;let e=t.floatingOriginOffset;switch(o){case"world":return p(e,r,a);case"view":return l(e,r,a);case"worldView":return F(e,r,t.getViewMatrix(),a);case"viewProjection":return w(e,t.getViewMatrix(),t.getProjectionMatrix(),a);case"worldViewProjection":return T(e,r,t.getTransformMatrix(),t.getViewMatrix(),t.getProjectionMatrix(),a);default:if(o.startsWith("u_")){let n=o.toLowerCase();if(n.startsWith("u_worldviewprojection"))return T(e,r,t.getTransformMatrix(),t.getViewMatrix(),t.getProjectionMatrix(),a);if(n.startsWith("u_viewprojection"))return w(e,t.getViewMatrix(),t.getProjectionMatrix(),a);if(n.startsWith("u_worldview"))return F(e,r,t.getViewMatrix(),a);if(n.startsWith("u_world"))return p(e,r,a);if(n.startsWith("u_view"))return l(e,r,a)}return r}}function z(){M.prototype.setMatrix=U,y._setMatrixOverride=void 0,d.prototype._updateMatrixForUniform=v,d.prototype._updateMatrixForUniformOverride=void 0}function D(){y.prototype._setMatrixOverride=U,y.prototype.setMatrix=function(o,r){return this._setMatrixOverride(o,V(o,r)),this},d.prototype._updateMatrixForUniformOverride=v,d.prototype._updateMatrixForUniform=function(o,r){this._updateMatrixForUniformOverride(o,V(o,r))}}var a,s,f,_,d,y,v,U,C=A(()=>{"use strict";P();h();j();R();a=new x,s=new x,f=new x,_={getScene:()=>{},eyeAtCamera:!0};d=O,y=M,v=d.prototype._updateMatrixForUniform,U=M.prototype.setMatrix});export{_ as a,l as b,B as c,E as d,W as e,z as f,D as g,C as h};
