import{a as h,b as p}from"./chunk-JCJHFP5I.js";import{g as o,i as u}from"./chunk-E23USBIP.js";import{c as n,d as r}from"./chunk-2AUPWM7R.js";import{e as a}from"./chunk-FAF55DAL.js";var c,d=a(()=>{"use strict";r();p();c=class extends h{constructor(t,e,s){super(t,e,s,3),this._newestInstance=null,this._privateInstances=new Set,this._state=1,this._instances=this._privateInstances,this.onEndedObservable=new n,this._onInstanceEnded=i=>{this._newestInstance===i&&(this._newestInstance=null),this._privateInstances.delete(i),this._instances.size===0&&(this._state=1,this.onEndedObservable.notifyObservers(this)),i.dispose()}}get activeInstancesCount(){return this._instances.size}get autoplay(){return this._options.autoplay}get currentTime(){let t=this._getNewestInstance();return t?t.currentTime:0}set currentTime(t){this.startOffset=t;let e=this._getNewestInstance();e&&(e.currentTime=t)}get loop(){return this._options.loop}set loop(t){this._options.loop=t}get maxInstances(){return this._options.maxInstances}set maxInstances(t){this._options.maxInstances=t}get startOffset(){return this._options.startOffset}set startOffset(t){this._options.startOffset=t}get state(){return this._state}dispose(){super.dispose(),this.stop(),this._newestInstance=null,this._privateInstances.clear(),this.onEndedObservable.clear()}pause(){let t=this._instances.values();for(let e=t.next();!e.done;e=t.next())e.value.pause();this._state=5}resume(){if(this._state!==5)return;let t=this._instances.values();for(let e=t.next();!e.done;e=t.next())e.value.resume();this._state=3}_beforePlay(t){if(this.state===5&&this._instances.size>0){this.resume();return}t.onEndedObservable.addOnce(this._onInstanceEnded),this._privateInstances.add(t),this._newestInstance=t}_afterPlay(t){this._state=t.state}_getNewestInstance(){if(this._instances.size===0)return null;if(!this._newestInstance){let t=this._instances.values();for(let e=t.next();!e.done;e=t.next())this._newestInstance=e.value}return this._newestInstance}_setState(t){this._state=t}_stopExcessInstances(){if(this.maxInstances<1/0){let t=Array.from(this._instances).filter(s=>s.state===3).length-this.maxInstances,e=this._instances.values();for(let s=0;s<t;s++)e.next().value.stop()}}}});var _,f=a(()=>{"use strict";r();u();_=class extends o{constructor(t){super(t.engine,2),this._state=1,this.onEndedObservable=new n,this.onErrorObservable=new n,this.onStateChangedObservable=new n,this._sound=t}get state(){return this._state}dispose(){super.dispose(),this.stop(),this.onEndedObservable.clear(),this.onStateChangedObservable.clear()}_setState(t){this._state!==t&&(this._state=t,this.onStateChangedObservable.notifyObservers(this),this._state===1&&this.onEndedObservable.notifyObservers(this))}}});export{c as a,d as b,_ as c,f as d};
