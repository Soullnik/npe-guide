import{a as E,b as O}from"./chunk-MEUTOEEX.js";import{e as d}from"./chunk-FAF55DAL.js";function D(o){let n=0;return{id_length:o[n++],colormap_type:o[n++],image_type:o[n++],colormap_index:o[n++]|o[n++]<<8,colormap_length:o[n++]|o[n++]<<8,colormap_size:o[n++],origin:[o[n++]|o[n++]<<8,o[n++]|o[n++]<<8],width:o[n++]|o[n++]<<8,height:o[n++]|o[n++]<<8,pixel_size:o[n++],flags:o[n++]}}function R(o,n){if(n.length<19){E.Error("Unable to load TGA file - Not enough data to contain header");return}let c=18,r=D(n);if(r.id_length+c>n.length){E.Error("Unable to load TGA file - Not enough data");return}c+=r.id_length;let _=!1,f=!1,u=!1;switch(r.image_type){case L:_=!0;case Y:f=!0;break;case P:_=!0;case k:break;case C:_=!0;case z:u=!0;break}let m,p=r.pixel_size>>3,g=r.width*r.height*p,s;if(f&&(s=n.subarray(c,c+=r.colormap_length*(r.colormap_size>>3))),_){m=new Uint8Array(g);let G,y,x,b=0,A=new Uint8Array(p);for(;c<g&&b<g;)if(G=n[c++],y=(G&127)+1,G&128){for(x=0;x<p;++x)A[x]=n[c++];for(x=0;x<y;++x)m.set(A,b+x*p);b+=p*y}else{for(y*=p,x=0;x<y;++x)m[b+x]=n[c++];b+=y}}else m=n.subarray(c,c+=f?r.width*r.height:g);let h,a,i,t,e,l;switch((r.flags&B)>>H){default:case X:h=0,i=1,l=r.width,a=0,t=1,e=r.height;break;case M:h=0,i=1,l=r.width,a=r.height-1,t=-1,e=-1;break;case v:h=r.width-1,i=-1,l=-1,a=0,t=1,e=r.height;break;case S:h=r.width-1,i=-1,l=-1,a=r.height-1,t=-1,e=-1;break}let w="_getImageData"+(u?"Grey":"")+r.pixel_size+"bits",I=V[w](r,s,m,a,t,e,h,i,l);o.getEngine()._uploadDataToTextureDirectly(o,I)}function F(o,n,c,r,_,f,u,m,p){let g=c,s=n,h=o.width,a=o.height,i,t=0,e,l,w=new Uint8Array(h*a*4);for(l=r;l!==f;l+=_)for(e=u;e!==p;e+=m,t++)i=g[t],w[(e+h*l)*4+3]=255,w[(e+h*l)*4+2]=s[i*3+0],w[(e+h*l)*4+1]=s[i*3+1],w[(e+h*l)*4+0]=s[i*3+2];return w}function K(o,n,c,r,_,f,u,m,p){let g=c,s=o.width,h=o.height,a,i=0,t,e,l=new Uint8Array(s*h*4);for(e=r;e!==f;e+=_)for(t=u;t!==p;t+=m,i+=2){a=g[i+0]+(g[i+1]<<8);let w=((a&31744)>>10)*255/31|0,I=((a&992)>>5)*255/31|0,U=(a&31)*255/31|0;l[(t+s*e)*4+0]=w,l[(t+s*e)*4+1]=I,l[(t+s*e)*4+2]=U,l[(t+s*e)*4+3]=a&32768?0:255}return l}function j(o,n,c,r,_,f,u,m,p){let g=c,s=o.width,h=o.height,a=0,i,t,e=new Uint8Array(s*h*4);for(t=r;t!==f;t+=_)for(i=u;i!==p;i+=m,a+=3)e[(i+s*t)*4+3]=255,e[(i+s*t)*4+2]=g[a+0],e[(i+s*t)*4+1]=g[a+1],e[(i+s*t)*4+0]=g[a+2];return e}function q(o,n,c,r,_,f,u,m,p){let g=c,s=o.width,h=o.height,a=0,i,t,e=new Uint8Array(s*h*4);for(t=r;t!==f;t+=_)for(i=u;i!==p;i+=m,a+=4)e[(i+s*t)*4+2]=g[a+0],e[(i+s*t)*4+1]=g[a+1],e[(i+s*t)*4+0]=g[a+2],e[(i+s*t)*4+3]=g[a+3];return e}function J(o,n,c,r,_,f,u,m,p){let g=c,s=o.width,h=o.height,a,i=0,t,e,l=new Uint8Array(s*h*4);for(e=r;e!==f;e+=_)for(t=u;t!==p;t+=m,i++)a=g[i],l[(t+s*e)*4+0]=a,l[(t+s*e)*4+1]=a,l[(t+s*e)*4+2]=a,l[(t+s*e)*4+3]=255;return l}function Q(o,n,c,r,_,f,u,m,p){let g=c,s=o.width,h=o.height,a=0,i,t,e=new Uint8Array(s*h*4);for(t=r;t!==f;t+=_)for(i=u;i!==p;i+=m,a+=2)e[(i+s*t)*4+0]=g[a+0],e[(i+s*t)*4+1]=g[a+0],e[(i+s*t)*4+2]=g[a+0],e[(i+s*t)*4+3]=g[a+1];return e}var Y,k,z,L,P,C,B,H,M,S,X,v,V,T=d(()=>{"use strict";O();Y=1,k=2,z=3,L=9,P=10,C=11,B=48,H=4,M=0,S=1,X=2,v=3;V={GetTGAHeader:D,UploadContent:R,_getImageData8bits:F,_getImageData16bits:K,_getImageData24bits:j,_getImageData32bits:q,_getImageDataGrey8bits:J,_getImageDataGrey16bits:Q}});var N,W=d(()=>{T();N=class{constructor(){this.supportCascades=!1}loadCubeData(){throw".env not supported in Cube."}loadData(n,c,r){let _=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),f=D(_);r(f.width,f.height,c.generateMipMaps,!1,()=>{R(c,_)})}}});export{D as a,R as b,V as c,T as d,N as e,W as f};
