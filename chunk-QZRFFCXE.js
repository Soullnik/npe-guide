import{k as m,l as T}from"./chunk-RIAPI5OR.js";import{A as M,u as d,v as o,z as h}from"./chunk-DYR6BFEB.js";import{e as x}from"./chunk-FAF55DAL.js";var u,b=x(()=>{"use strict";M();T();u=class{constructor(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}getNormal(f=!1,l=!0){if(!this.pickedMesh||l&&!this.pickedMesh.isVerticesDataPresent(m.NormalKind))return null;let e=this.pickedMesh.getIndices();e?.length===0&&(e=null);let i,c=h.Vector3[0],n=h.Vector3[1],I=h.Vector3[2];if(l){let t=this.pickedMesh.getVerticesData(m.NormalKind),r=e?o.FromArrayToRef(t,e[this.faceId*3]*3,c):c.copyFromFloats(t[this.faceId*3*3],t[this.faceId*3*3+1],t[this.faceId*3*3+2]),s=e?o.FromArrayToRef(t,e[this.faceId*3+1]*3,n):n.copyFromFloats(t[(this.faceId*3+1)*3],t[(this.faceId*3+1)*3+1],t[(this.faceId*3+1)*3+2]),a=e?o.FromArrayToRef(t,e[this.faceId*3+2]*3,I):I.copyFromFloats(t[(this.faceId*3+2)*3],t[(this.faceId*3+2)*3+1],t[(this.faceId*3+2)*3+2]);r=r.scale(this.bu),s=s.scale(this.bv),a=a.scale(1-this.bu-this.bv),i=new o(r.x+s.x+a.x,r.y+s.y+a.y,r.z+s.z+a.z)}else{let t=this.pickedMesh.getVerticesData(m.PositionKind),r=e?o.FromArrayToRef(t,e[this.faceId*3]*3,c):c.copyFromFloats(t[this.faceId*3*3],t[this.faceId*3*3+1],t[this.faceId*3*3+2]),s=e?o.FromArrayToRef(t,e[this.faceId*3+1]*3,n):n.copyFromFloats(t[(this.faceId*3+1)*3],t[(this.faceId*3+1)*3+1],t[(this.faceId*3+1)*3+2]),a=e?o.FromArrayToRef(t,e[this.faceId*3+2]*3,I):I.copyFromFloats(t[(this.faceId*3+2)*3],t[(this.faceId*3+2)*3+1],t[(this.faceId*3+2)*3+2]),F=r.subtract(s),y=a.subtract(s);i=o.Cross(F,y)}let p=(t,r)=>{if(this.thinInstanceIndex!==-1){let a=t.thinInstanceGetWorldMatrices()[this.thinInstanceIndex];a&&o.TransformNormalToRef(r,a,r)}let s=t.getWorldMatrix();t.nonUniformScaling&&(h.Matrix[0].copyFrom(s),s=h.Matrix[0],s.setTranslationFromFloats(0,0,0),s.invert(),s.transposeToRef(h.Matrix[1]),s=h.Matrix[1]),o.TransformNormalToRef(r,s,r)};if(f&&p(this.pickedMesh,i),this.ray){let t=h.Vector3[0].copyFrom(i);f||p(this.pickedMesh,t),o.Dot(t,this.ray.direction)>0&&i.negateInPlace()}return i.normalize(),i}getTextureCoordinates(f=m.UVKind){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(f))return null;let l=this.pickedMesh.getIndices();if(!l)return null;let e=this.pickedMesh.getVerticesData(f);if(!e)return null;let i=d.FromArray(e,l[this.faceId*3]*2),c=d.FromArray(e,l[this.faceId*3+1]*2),n=d.FromArray(e,l[this.faceId*3+2]*2);return i=i.scale(this.bu),c=c.scale(this.bv),n=n.scale(1-this.bu-this.bv),new d(i.x+c.x+n.x,i.y+c.y+n.y)}}});export{u as a,b};
